root@gajl-bbc-onlinec-com-1585211:/workspace# python /home/users/chenquanlin/test.py
================================================================================
Sparse MLA Forward 优化方案性能对比
================================================================================
配置: B=1, S=2048, SKV=2048, H=2, HKV=1
      DQK=320, DV=256, topk=2048
      block_I=64, num_stages=1, threads=128 (优化1配置)
================================================================================

测试: 原始方案 (优化1配置)
----------------------------------------
  ✓ 正确性验证通过
  平均时间: 1.0650 ms
  带宽: 2.52 TB/s
  TFLOPS: 9.07

测试: 优化7: 批量处理 Query (S=8)
----------------------------------------
2025-12-18 15:23:33  [TileLang:tilelang.jit.kernel:INFO]: TileLang begins to compile kernel `main` with `out_idx=[-2, -1]`
2025-12-18 15:23:59  [TileLang:tilelang.jit.kernel:INFO]: TileLang completes to compile kernel `main`
  ✗ 正确性验证失败，最大差异: 0.257812
  平均时间: 0.2228 ms
  带宽: 12.05 TB/s
  TFLOPS: 43.37

================================================================================
性能汇总
================================================================================
方案                             时间(ms)       带宽(TB/s)     TFLOPS     相对基准      
--------------------------------------------------------------------------------
原始方案 (优化1配置)                   1.0650       2.52         9.07       1.00      x
优化7: 批量处理 Query (S=8)          0.2228       12.05        43.37      4.78      x
================================================================================
